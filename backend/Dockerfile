# üåø Ecoride Backend - Dockerfile Render (PHP + PostgreSQL)

# √âtape 1 : image de base PHP 8.3 avec Composer
FROM php:8.3-cli

# √âtape 2 : installer les extensions n√©cessaires (PostgreSQL + utilitaires)
RUN apt-get update && apt-get install -y \
    libpq-dev \
    unzip \
    git \
 && docker-php-ext-install pdo pdo_pgsql \
 && rm -rf /var/lib/apt/lists/*

# √âtape 3 : installer Composer
COPY --from=composer:2 /usr/bin/composer /usr/bin/composer

# √âtape 4 : copier le backend dans le conteneur
WORKDIR /app/backend
COPY . /app/backend

# √âtape 5 : installer les d√©pendances PHP (en ignorant Mongo si non dispo)
RUN composer install --no-interaction --no-progress --ignore-platform-req=ext-mongodb

# √âtape 6 : exposer le port Render
EXPOSE 10000

# √âtape 7 : d√©marrer le serveur PHP int√©gr√©
CMD ["php", "-S", "0.0.0.0:10000", "router.php"]

