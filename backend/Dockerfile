# ============================================================
# ðŸš€ Dockerfile pour backend PHP (Render)
# ============================================================

# Ã‰tape 1 : Image de base PHP
FROM php:8.3-cli

# Ã‰tape 2 : Installer les extensions nÃ©cessaires
RUN apt-get update && apt-get install -y \
    libpq-dev \
    unzip \
    git \
    && docker-php-ext-install pdo pdo_pgsql \
    && rm -rf /var/lib/apt/lists/*

# Ã‰tape 3 : Installer Composer (pour les dÃ©pendances PHP)
COPY --from=composer:2 /usr/bin/composer /usr/bin/composer

# Ã‰tape 4 : Copier le code du backend
WORKDIR /app/backend
COPY . /app/backend

# Ã‰tape 5 : Installer les dÃ©pendances PHP (sans lâ€™extension Mongo)
RUN composer install --no-interaction --no-progress --ignore-platform-req=ext-mongodb

# Ã‰tape 6 : Exposer le port 10000 (Render lâ€™utilise par dÃ©faut)
EXPOSE 10000

# Ã‰tape 7 : Commande de dÃ©marrage
CMD ["php", "-S", "0.0.0.0:10000", "router.php"]

